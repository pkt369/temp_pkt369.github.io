---
layout : posts

title : "프로세스와 스레드의 차이"

date : 2021-07-13

categories : operatingSystem

comments : true
---



면접의 가장 단골 질문이 프로세스와 스레드 차이가 아닐까 싶다.

그만큼 중요하지만 모르는 사람이 많다는 뜻인것 같다.

프로그램, 프로세스, 스레드에 대해 알아보자.

<br>

### 프로그램

프로세스를 이해하기 위해서는 프로그램을 이해해야 한다.

우리가 흔히 아는 프로그램은 크롬, exe로 된 파일 등등 여러가지 파일들이 있다.

즉, 실행되지 않은 정적인 파일들을 의미한다.

<br>

### 프로세스

이 파일들이 운영체제에 올라가서 실행된 것이 프로세스이다.

정리하자면 프로세스는 운영체제로부터 자원을 할당받은 작업의 단위를 의미한다.

![process](https://user-images.githubusercontent.com/66049273/125396603-bb0bdf00-e3e7-11eb-97fe-27f95fa76250.png)

 이미지 출처 : [Heee's Development Blog](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)

<br>

프로세스는 운영체제의 최소 작업 단위이다. 

또한 하나의 프로세스는 하나 이상의 스레드를 가지고 있다.

<br>

과거에는 한 프로세스로 실행 시작부터 실행 끝까지 하나의 프로세스만을 사용하였다고 한다.

시간이 지나면서 복잡한 프로그램들이 나오기 시작하면서 한가지 작업만 하는 경우 없어졌다.

운영체제에서는 프로세스마다 자신에게 할당된 메모리에만 접근할수 있도록 하기때문에 멀티 프로세스말고 다른 방법이 필요했다.

<br>

### 스레드

한 프로세스에서 여러가지일을 하기 위해 더 작은 실행 단위로 나뉜 것이 스레드이다.

정리하자면 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위이다.

<br>

스레드는 프로세스간에 메모리를 공유하면서 사용한다.

좀더 자세히 설명하자면 Code, Data, Heap는 공유하고 Stack은 스레드마다 따로 할당한다.

![thread](https://user-images.githubusercontent.com/66049273/125396393-71bb8f80-e3e7-11eb-9a9d-68f3a93ce661.png)

 이미지 출처 : [Heee's Development Blog](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)

<br>

스레드는 CPU 의 최소 작업 단위이다. 

즉, CPU는 작업을 처리할 때 스레드를 최소 단위를 잡고 작업을 한다.

<br>

### 멀티 프로세스

멀티 프로세스는 운영체제가 서로 공유를 못한다고 위에서 언급을 한적이있다.

그럼 만약 한 프로세스가 오류가 나서 강제로 종료가 되게 된다면, 다른 프로세스 어떻게 될까?

정답은 아무 영향이 없다이다.  즉, 멀티프로세스의 장점은 오류가 나도 확산이 되지 않는 것이다.

<br>

하지만 단점으로는 Context Switching 과정에서 캐쉬 메모리 초기화 등 무거운 작업이 진행되고 많은 시간이 소모되는 등의 오버헤드가 발생한다.

<br>

참고) 오버헤드 : 어떤 처리를 하기 위해 들어가는 간적접인 처리 시간, 메모리 등을 말한다.

참고) Context Switching

컨텍스트 스위칭은 CPU에서 여러 프로세스를 돌면서 작업을 처리하는 것이다.

동시에 처리하는 것처럼 보이나 실제로는 하나씩 엄청 빠르게 처리하고 있는것이다.

동작 중인 프로세스가 대기를 하면서 프로세스의 상태(Context)를 보관하고, 대기하고 있던 다음 순서의 프로세스가 동작하면서 이전에 보관했던 프로세스의 상태를 복구하는 작업을 말한다.

<br>

추가적으로 사실 프로세스도 다른 프로세스에 접근을 할 수 있다.

1. IPC(Inter-Process Communication)
2. LPC(Local inter-Process Communication)
3. 별도 공유 메모리 생성 후 주고받도록 설정

다음 번에 주제로 포스팅해보겠다.

<br>

### 멀티 스레드

우리가 위에서 설명했듯이 스레드는 하나의 프로세스안에 하나 이상의 스레드를 가질 수 있다.

멀티 스레드는 Context-Switching할 때 공유하고 있는 메모리만큼 자원을 아낄수 있고, Stack을 제외한 영역을 공유하고 있기때문에 응답시간이 빠르다는 장점이 있다.

<br>

하지만 멀티 프로세스에서는 지금 프로세스가 오류가 나도 다른 프로세스는 영향이 없지만, 멀티 스레드 같은 경우는 한 스레드가 오류가 걸릴 경우 모든 스레드가 영향을 받게 된다.

또한 멀티 스레드는 동기화 문제(Synchronization Issue)가 있다.

멀티 스레드는 어떤 순서로 실행될 지 모르기 때문에 A 스레드가 사용하는 공유된 자원은 B 스레드가 변경을 하게 되었을 경우 A 스레드가 접근 하지 못하거나 바뀐 값에 접근 하는 등의 오류가 발생할 수 있다.

<br>

또한 스케줄링을 운영체제가 자동으로 해주지 않으므로 프로그래머가 적절한 기법으로 직접 구현해야한다.

하지만 왜 멀티 프로세스보다 멀티 스레드를 더 많이 쓰고 선호할까?

<br>

### 멀티 프로세스보다 멀티 스레드를 선호하는 이유

위에서 사실 이미 설명하면서 비교를 했으나 멀티 스레드를 좀더 선호하는 이유를 다시 알아보자.

<br>

멀티 프로세스 같은 경우 Context-Switching 같은 경우 CPU 레지스터 교체 뿐만아니라 RAM과 CPU 사이의 캐쉬 메모리에 대한 데이터까지 초기화되므로 오버헤드가 크다.

반면 스레드같은 경우 공유된 데이터가 있어서 주고받는 것이 간단하고 자원을 효율적으로 관리가 가능하다.

<br>

### 정리

정적인 프로그램을 실행하면 운영체제에 올라가서 프로세스가 생성되고,  한 프로세스 안에는 하나 이상의 스레드가 존재한다.

스레드는 Code, Data, Heap 영역을 공유하고 Stack만 각 스레드에 할당하여 사용한다.

공유된 메모리가 있기에 Context-Switching이 빠르며, 소모 비용이 낮다.

그렇기 때문에 멀티 프로세스 보단 멀티스레드를 보통 사용한다.

하지만 스케줄링을 운영체제가 자동으로 해주지 않기 때문에 스레드의 문제인 동기화 이슈에 대응해야 한다.

<br>

### 면접 질문 중 하나인 스레드와 프로세스의 차이

위에서 읽은 것들을 정리한 것이다.

프로세스는 서로 공유가 되지 않는 반면 스레드는 한 프로세스안에서 Code, Data, Heap을 공유해서 사용하기 때문에 Context-Switching이 빠르다.

또 프로세스는 공유가 되지않기때문에 다른 프로세스에서 오류가 나도 다른 프로세스에는 영향이 가지 않는 반면 스레드는 공유하기 때문에 하나라도 오류가 걸릴 경우 전체 스레드에 영향이 간다.









