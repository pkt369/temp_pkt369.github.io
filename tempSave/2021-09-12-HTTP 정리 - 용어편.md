---
layout : posts

title : "HTTP 정리 - 용어편"

date : 2021-09-02

categories : http

comments : true
---



그동안 너무 공부를 얇고 넓게 공부해온 것 같아서 이제부터는 좀더 깊게 공부해볼려고 한다. 그 첫번째 주제로 http에 대해서 공부한 것을 정리하여 포스팅할 것이다.

### HTTP 란

HTTP(Hypertext Transfer Protocol) 는 웹 서버와 웹 클라이언트가 대화하기 위해 쓰이는 공용어이다. 웹 클라이언트가 웹 서버에 요청을 할 때 또는 웹 서버에서 응답을 할 때 같은 용어로 주고받는다는 이야기이다. 쉽게 설명하면 영어를 모르는 한국 사람과 한글을 모르는 미국 사람이 서로 대화가 통하지 않지만 서로 같은 언어를 할 줄 알면 대화를 할 수 있다. 이처럼 같은 언어를 쓰도록 규정해놓은 것이 http 라고 할 수 있다.



##### 리소스

웹은 여러가지 요소를 가지고 있다. 첫번째로 **리소스**가 있다. 리소스의 경우에는 우리가 흔히아는 컨텐츠와 관련된 부분이다. 예를 들어 avi, mp4, jpg, png, 그리고 주식 거래, 검색 시스템 등을 예를 들 수 있다.

##### 미디어 타입

리소스를 주면 웹 클라이언트가 어떻게 알 수 있을까? 바로 미디어 타입(MIME)으로 알 수 있다. 웹에서 전송하는 객체의 각각에 MIME(Multipurpose Internet Mail Extensions)타입이라는 데이터 포멧 라벨을 붙인다. MIME 는 원래 각기 다른 전자메일 시스템 사이에서 메세지가 오고 갈 때 겪는 문제점을 해결하기 위해 설계되었는데 이메일에서 너무 잘 동작 되었기 때문에 HTTP에서 채택되었다.

미디어 타입은 사선(/)으로 구분되는데 주 타입(Primary object type)과 부 타입(specific subtype)으로 이루어진 문자열 라벨이다. 예를 들면 `Content-type: image/jpeg`,  `Content-type: text/html` 등이 있다.

##### 주소(URI)

서버 리소스 이름은 URI(Uniform resource identifier) 혹은 통합 자원 식별자라고 불린다. 쉽게 말해서 집주소와 같다. 예를들어 `https://www.google.com/images/logo.png` 가 있는 경우 https 는 http 프로토콜을 사용한다는 의미이고 www.google.com은 google 로 이동한다는 뜻이고 `/images/logo` 의 경우는 리소스를 가져오라는 뜻이다. 

주소(URI)에는 두가지가 있는데 URL과 URN 이 있다.

##### URL

URL(Uniform resource locator)은 통합 자원 지시자라고도 불리며 우리가 인터넷을 사용할 때 가장 많이 들어본 용어이기도 하다. URL은 특정 서버의 한 리소스에 대한 구체적인 위치를 가리킨다. URL은 세 부분으로 표준 포맷을 따른다.

- URL의 첫 부분은 스킴(scheme)이라고 하는데, 리소스에 접근하기 위해 사용되는 프로토콜을 서술한다.
- 두번째 부분은 서버의 인터넷 주소를 제공한다. 예를들어 아까 URI 에서 설명한 www.google.com을 예로 들수 있다.
- 세번째는 웹 서버의 리소스를 가리킨다. URI에서 설명한 `/images/logo.png`를 예로 들 수 있다.

그럼 URI와 URL은 같은 거 아니야? 라는 의문이 생길수 있다. 사실 오늘날 대부분은 URI는 URL이다. 하지만 굳이 차이점을 두자면 https://www.google.com/images/logo 는 URI는 될수 있으나 URL은 될 수 없다 그 이유는 logo라는 직접적인 주소가 없고 서버에서 처리하여 리턴해주기 때문이다. https://www.google.com/images/logo.png은 정확한 리소스 주소를 가리키고 있기때문에 URI와 URL 둘다 될 수 있다.

##### URN

URN(Uniform resource name)은 유니폼 리소스 이름이다. URN은 콘텐츠를 이루는 한 리소스의 위치에 영향 받지 않고 이름으로 찾는다. 주소와 상관없이 리소스를 가져올 수 있는 것을 URN이라고 한다. URN 같은 경우 아직 널리 채택되지 않았다.

##### 트랜잭션

트랜잭션은 주고 받는 것을 의미한다. HTTP 트랜잭션은 요청 명령과 응답 결과로 구성되어 있으며, HTTP 메세지라고 불리는 정형화된 데이터가 있다. 데이터에는 메서드, 상태코드, 메세지헤더, 메세지바디 등으로 이루어져 있다.

##### 메서드

HTTP 메서드는 GET, POST, PUT, DELETE, UPDATE가 있다. 모든 요청 메세지에는 한 개의 메서드를 가지며, 서버에게 어떤 동작이 이루어져야하는지 말해준다.

##### 상태코드

모든 HTTP 응답 메세지에는 상태 코드와 함께 반환된다. 상태 코드란 요청에 관련한 정보를 세자리 숫자로 넘겨주는것이다. 예를 들어 성공의 경우는 200을 사용하고, 리소스가 없는 경우에는 404를 반환한다.

##### 메세지

HTTP 메세지 단순한 줄 단위의 문자열이다. 메세지는 요청 메세지와 응답 메세지가 있으며, 3가지로 나뉜다.

- 시작줄 : 메세지의 첫줄은 시작줄로, 요청이라면 무엇을 해야하는지 응답이라면 무슨 일이 일어났는지 나타낸다.
- 헤더 : 시작줄다음에는 헤더 필드가 이어서 나타난다. 헤더 필드는 키와 값으로 이루어져 있으며 ":"으로 키와 값을 구분한다. 헤더 필드에는 한 줄당 하나의 헤더가 나타난다.
- 본문 : 아무 데이터나 들어갈 수 있으며, 보통 메세지 바디라고 불린다. 메서드가 GET 이고 요청일때는 메세지 바디가 없다. 응답의 경우에는 클라이언트에게 반환할 데이터를 담아서 보낸다.

##### TCP 커넥션

메세지가 TCP(Transmission Control Protocol)커넥션을 통해 클라이언트와 서버가 서로 주고받는다. 다음 TCP/IP에서 더 알아보자

##### TCP/IP

HTTP는 애플리케이션 계층 프로토콜이다. HTTP는 네트워크 통신의 핵심적인 세부 사항에 대해 신경 쓰지 않고 TCP/IP에게 맡긴다. TCP는 다음을 제공한다.

- 오류 없는 데이터 전송
- 순서에 맞는 전달 (데이터는 언제나 보낸 순서대로 도착한다.)
- 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있다.)

TCP/IP는 TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜의 집합이다. TCP/IP는 각 네트워크와 하드웨어의 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크와 서로 신뢰성 있는 의사소통을 하게 해 준다. 네트워크 개념상 HTTP 프로토콜은 TCP 위의 계층이다. HTTP는 자신의 메세지를 데이터에 전송하기 위해 TCP를 사용한다. TCP는 IP위의 계층이다.

![HttpProtocol](https://user-images.githubusercontent.com/66049273/133211451-a3c0afd8-de9a-44ed-bfb2-394b1e48179a.png)

##### TCP/IP 디테일

HTTP 클라이언트가 메세지를 전송하기 위해서는 먼저 IP와 포트번호를 사용해 클라이언트와 서버 사이에 TCP/IP 커넥션을 맺어야 한다. IP는 `www.google.com` 같은 주소를 뜻하는 거고 포트는 주소뒤에 `:8080`이렇게 붙는 것을 말한다. IP에는 `www.google.com`처럼 호스트 명을 쓸수도 있고 182.000.00.33 같은 IP 주소를 쓸수도 있다. 호스트명은 도메인 이름 서비스(DNS: Domain Name Service)라고도 불리며, 사람이 이해하기 쉬운 형태로 변환하여 쓴다. 여기서  `www.google.com`을 들어갈때 포트번호가 없어서 궁금증이 생길 수 있다. 포트 번호가 없는 경우에는 http의 경우에는 80, https 의 경우에는 443이 숨겨져 있다. 

정리를 하자면 웹 브라우저가 요청할 URL에서 호스트명을 먼저 꺼내고 호스트명을 IP로 전환한다. 이후 URL에서 포트번호가 있는지 확인하고 있으면 추출한다. 추출 후 웹 브라우저와 웹 서버가 TCP 커넥션을 맺고 요청 및 응답을 주고받는다.

